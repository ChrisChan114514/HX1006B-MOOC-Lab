# lab_2_2 - 正弦/余弦波发生器

## 项目概述

本实验设计了基于ROM查找表的正弦波和正余弦波发生器。通过7位计数器循环遍历ROM地址，从ROM中读取预存的正弦波采样数据，实现8位数字正弦波和余弦波信号输出。

本工程包含两个设计：

1. **正弦波发生器** (`sin_gen.v`) - 输出单路正弦波信号
2. **正余弦波发生器** (`sincos_gen.v`) - 同时输出正弦波和余弦波信号

## 工程文件说明

### 主要设计文件

- **`sin_gen.v`** - 正弦波发生器模块
  - 内部实现7位计数器（0-127循环计数）
  - 使用 `$readmemh` 从文本文件读取正弦波数据到ROM数组
  - 以计数器值作为ROM地址，输出对应的8位正弦波数据

- **`sincos_gen.v`** - 正余弦波发生器模块
  - 在正弦波基础上增加余弦波输出
  - 余弦波通过地址偏移32（π/2相位差）实现：`cnt_c = cnt + 32`
  - 同时输出8位正弦波和8位余弦波数据

### 数据文件

- **`rom78.txt`** - ROM初始化数据文件
  - 包含128个8位正弦波采样点（十六进制格式）
  - 数据范围：0x00到0xFF，对应一个完整的正弦波周期
  - 采样点按正弦函数均匀分布

### 仿真文件

- **`sin_gen_tb.v`** - 正弦波发生器测试台
  - 用于ModelSim仿真验证正弦波输出
  - 提供时钟、复位、使能信号

- **`sincos_gen_tb.v`** - 正余弦波发生器测试台
  - 用于ModelSim仿真验证正弦波和余弦波输出
  - 观察两路输出的相位关系

### 工程配置文件

- **`sin_gen.qpf`** - Quartus工程文件
- **`sin_gen.qsf`** - Quartus设置文件，包含引脚分配和器件配置
- **`db/`** - Quartus数据库目录

## Verilog程序设计

### 模块1：正弦波发生器 (sin_gen)

#### 端口定义（sin_gen）

| 端口   | 方向   | 位宽 | 说明                   |
| ------ | ------ | ---- | ---------------------- |
| clk    | input  | 1    | 系统时钟               |
| rst_n  | input  | 1    | 异步复位（低电平有效） |
| en     | input  | 1    | 使能信号               |
| Q[7:0] | output | 8    | 8位正弦波数据输出      |

#### 功能说明（sin_gen）

1. **7位计数器**
   - 在时钟上升沿递增计数，范围0-127
   - 支持异步低电平复位
   - 使能信号控制计数

2. **ROM查找表**
   - 使用 `reg [7:0] sinrom[127:0]` 定义128深度、8位宽的ROM数组
   - 通过 `initial $readmemh("rom78.txt", sinrom)` 初始化ROM数据
   - 根据计数器地址输出对应的正弦波采样值

3. **输出寄存器**
   - 时钟同步输出，确保时序稳定

### 模块2：正余弦波发生器 (sincos_gen)

#### 端口定义（sincos_gen）

| 端口       | 方向   | 位宽 | 说明                   |
| ---------- | ------ | ---- | ---------------------- |
| clk        | input  | 1    | 系统时钟               |
| rst_n      | input  | 1    | 异步复位（低电平有效） |
| en         | input  | 1    | 使能信号               |
| q_sin[7:0] | output | 8    | 8位正弦波数据输出      |
| q_cos[7:0] | output | 8    | 8位余弦波数据输出      |

#### 功能说明（sincos_gen）

1. **正弦波输出**
   - 与 `sin_gen` 模块相同，使用计数器值作为ROM地址

2. **余弦波输出**
   - 余弦波相位超前正弦波90度（π/2）
   - 在128采样点中，90度对应32个采样点
   - 余弦地址：`cnt_c = cnt + 32`
   - 使用相同的ROM数据，通过地址偏移实现相位差

3. **同步输出**
   - 正弦和余弦数据在同一时钟沿同步输出

## ModelSim仿真

### 正弦波仿真

使用 `sin_gen_tb.v` 进行仿真：

- 时钟周期：100ns（10MHz）
- 时间刻度：`timescale 10ns/100ps`
- 复位时间：100ns后释放
- 仿真时长：5000个时间单位（500μs）
- 观察 `Q[7:0]` 输出，应看到128个点的正弦波形循环输出

### 正余弦波仿真

使用 `sincos_gen_tb.v` 进行仿真：

- 仿真参数与正弦波相同
- 观察 `q_sin[7:0]` 和 `q_cos[7:0]` 输出
- 验证余弦波相位超前正弦波90度

ChrisChan
2025/10/27
